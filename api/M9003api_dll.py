# -*- coding: utf-8 -*-"""Created on Thu Jan 11 11:47:48 2018@author: Gembu Maryu"""from ctypes import *#load DLLdll = windll.LoadLibrary('./M9003api.dll')# get handledll.M9003Open.restype=wintypes.HANDLEhM9003 = dll.M9003Open() print('GetHandle: ', hM9003)# Reset handle : this process must be done before use counting board dll.M9003Reset(hM9003)# Set parametersg_time=10 # ToDO: assign via GUIdll.M9003Setup.restype = c_booldll.M9003Setup.argtypes = [wintypes.HANDLE, wintypes.BYTE, wintypes.BYTE,                            wintypes.BYTE, wintypes.BYTE, wintypes.BYTE, wintypes.BYTE]b_setting = dll.M9003Setup(hM9003, 0x08, 0x03, 0x00, g_time, 0, 0x01)print('Setting: ', b_setting)# Read Data'''dll.M9003ReadData.restype = c_booldataBuffer=pointer(wintypes.DWORD(10))dataLength=pointer(wintypes.DWORD(10))'''import numpy as npdataBuffer=(wintypes.DWORD*1670000*2)()dataLength=byref(wintypes.DWORD(200000))rd = dll.M9003ReadData(hM9003, dataBuffer, dataLength)print('ReadData: ', rd)# Count Stop : this process must be done before M9003GetInfodll.M9003CountStop.restype = c_boolcs = dll.M9003CountStop(hM9003)print('CountStop', cs)# Get Informationinfo=c_int16()dll.M9003GetInfo.restype = c_bool#dll.M9003GetInfo.argtypes =(, c_int16)getinfo = dll.M9003GetInfo(hM9003, byref(info))print("GetInfo: ", getinfo)print("info value: ", info.value)'''# Read Portdll.M9003ReadPort.restype = c_boolData = wintypes.BYTE()rp = dll.M9003ReadPort(hM9003, byref(Data))#print("ReadPort: ", rp)print(Data)# Write Portdll.M9003WritePort.restype = c_boolwp = dll.M9003WritePort(hM9003, byref(Data))print("WritePort: ", wp)'''dll.M9003Close.restype = c_boolcl = dll.M9003Close(hM9003)print(cl)hoge = cast(dataBuffer, POINTER(wintypes.DWORD))list = [hoge[i] for i in range(1670000)]